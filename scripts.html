<!-- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã®èª­ã¿è¾¼ã¿ -->
<script>console.log('ğŸ”§ Constantsèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('utils\\constants'); ?>
<script>console.log('ğŸ”§ Constantsèª­ã¿è¾¼ã¿å®Œäº†');</script>

<script>console.log('ğŸ”§ DataLoaderèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('utils\\dataLoader'); ?>
<script>console.log('ğŸ”§ DataLoaderèª­ã¿è¾¼ã¿å®Œäº†');</script>

<!-- JavaScriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®èª­ã¿è¾¼ã¿ -->
<script>console.log('ğŸ”§ Authèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('components\\auth'); ?>
<script>console.log('ğŸ”§ Authèª­ã¿è¾¼ã¿å®Œäº†');</script>

<script>console.log('ğŸ”§ StudentInfoèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('components\\studentInfo'); ?>
<script>console.log('ğŸ”§ StudentInfoèª­ã¿è¾¼ã¿å®Œäº†');</script>

<script>console.log('ğŸ”§ SubjectListèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('components\\subjectList'); ?>
<script>console.log('ğŸ”§ SubjectListèª­ã¿è¾¼ã¿å®Œäº†');</script>

<script>console.log('ğŸ”§ Registrationèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('components\\registration'); ?>
<script>console.log('ğŸ”§ Registrationèª­ã¿è¾¼ã¿å®Œäº†');</script>

<script>console.log('ğŸ”§ Summaryèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('components\\summary'); ?>
<script>console.log('ğŸ”§ Summaryèª­ã¿è¾¼ã¿å®Œäº†');</script>

<script>console.log('ğŸ”§ TabNavigationèª­ã¿è¾¼ã¿é–‹å§‹');</script>
<?!= include('components\\tabNavigation'); ?>
<script>console.log('ğŸ”§ TabNavigationèª­ã¿è¾¼ã¿å®Œäº†');</script>

<!-- ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ -->
<?!= include('main'); ?>

<script>
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼ˆäº’æ›æ€§ç¶­æŒã®ãŸã‚ï¼‰
    let studentData = {};
    let subjectData = [];
    let registeredSubjects = [];

    // æ—§é–¢æ•°åã¨ã®äº’æ›æ€§ç¶­æŒï¼ˆæ®µéšçš„ç§»è¡Œã®ãŸã‚ï¼‰
    function loadStudentInfo() {
        App.loadStudentData();
    }

    function loadSubjects() {
        App.loadSubjectData();
    }

    function loadRegistrations() {
        App.loadRegistrationData();
    }

    function displayAvailableSubjects() {
        SubjectList.displayAvailable();
    }

    function displayRegisteredSubjects() {
        SubjectList.displayRegistered();
    }

    function updateSummary() {
        Summary.update();
    }

    function registerSubject(subjectId) {
        Registration.register(subjectId);
    }

    function unregisterSubject(subjectId) {
        Registration.unregister(subjectId);
    }

    // æ‰‹å‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ç”¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
    function refreshData() {
        App.refresh();
    }

    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆç”¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ï¼ˆHTMLã‹ã‚‰å‘¼ã³å‡ºã—ç”¨ï¼‰
    function showTab(tabName) {
        // DOMContentLoadedã‚’å¾…ã£ã¦ã‹ã‚‰TabNavigationã‚’å‘¼ã³å‡ºã™
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                showTab(tabName);
            });
            return;
        }

        if (window.TabNavigation && TabNavigation.showTab) {
            TabNavigation.showTab(tabName);
        } else {
            console.error('TabNavigationã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
            console.log('åˆ©ç”¨å¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:', Object.keys(window).filter(k => k.includes('Tab')));
        }
    }

    // DOMèª­ã¿è¾¼ã¿å®Œäº†å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
        console.log('ğŸ”§ DOMContentLoaded: ã™ã¹ã¦ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');

        // å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®èª­ã¿è¾¼ã¿çŠ¶æ³ç¢ºèª
        console.log('ğŸ“¦ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã¿çŠ¶æ³:');
        console.log('  - Auth:', !!window.Auth);
        console.log('  - App:', !!window.App);
        console.log('  - DataLoader:', !!window.DataLoader);
        console.log('  - TabNavigation:', !!window.TabNavigation);
        console.log('  - StudentInfo:', !!window.StudentInfo);
        console.log('  - Registration:', !!window.Registration);
        console.log('  - Summary:', !!window.Summary);
        console.log('  - SubjectList:', !!window.SubjectList);

        // TabNavigationãŒåˆ©ç”¨å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
        if (window.TabNavigation) {
            console.log('TabNavigation methods:', Object.keys(TabNavigation));
        }

        // ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
        const tabButtons = document.querySelectorAll('.tab-button');
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                console.log('ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯:', tabName);
                if (tabName) {
                    showTab(tabName);
                }
            });
        });
    });
</script>